<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Hub [View]</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.1/spectrum.min.css">
    <link rel="stylesheet" href="view.css">
</head>
<body>
    <!-- Top Bar -->
    <div id="top-bar">
        <div class="top-bar-left">
            <img id="company-logo" src="logo.png" alt="Logo" onerror="this.style.display='none'">
            <div id="title-block">
                <a href="index.html" id="worksheet-title">Project Hub</a>
                <span id="worksheet-subtitle">View</span>
            </div>
        </div>
        <div id="top-bar-center">
            <span id="project-name-label"></span>
        </div>
        <div class="top-bar-right">
            <a href="index.html" class="nav-link"><i class="fa fa-house"></i> Home</a>
            <a href="design.html" class="nav-link"><i class="fa-solid fa-wand-magic-sparkles"></i> Design</a>
            <a href="update.html" class="nav-link"><i class="fa-solid fa-arrows-up-down-left-right"></i> Update</a>


        </div>
    </div>

    <!-- Toolbar -->
    <div id="toolbar">
        <div class="toolbar-group">
            <button id="btn-projects" title="Open Projects"><i class="fa fa-folder-open"></i></button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
            <button id="btn-undo" title="Undo (Ctrl+Z)" disabled><i class="fa fa-rotate-left"></i></button>
            <button id="btn-redo" title="Redo (Ctrl+Y)" disabled><i class="fa fa-rotate-right"></i></button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
            <button id="btn-bold" title="Bold"><i class="fa fa-bold"></i></button>
            <button id="btn-italic" title="Italic"><i class="fa fa-italic"></i></button>
            <button id="btn-underline" title="Underline"><i class="fa fa-underline"></i></button>
            <button id="btn-strikethrough" title="Strikethrough"><i class="fa fa-strikethrough"></i></button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
            <button id="btn-bg-color" title="Apply Background Color">
                <i class="fa fa-fill-drip"></i>
                <span class="color-indicator" id="bg-color-indicator" style="background-color: #ffffff;"></span>
            </button>
            <input type="text" id="bg-color-picker" class="color-picker-input">
            <button id="btn-font-color" title="Apply Font Color">
                <i class="fa fa-font"></i>
                <span class="color-indicator" id="font-color-indicator" style="background-color: #000000;"></span>
            </button>
            <input type="text" id="font-color-picker" class="color-picker-input">
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
            <button id="btn-align-left" title="Align Left"><i class="fa fa-align-left"></i></button>
            <button id="btn-align-center" title="Center Align"><i class="fa fa-align-center"></i></button>
            <button id="btn-align-right" title="Right Align"><i class="fa fa-align-right"></i></button>
            <button id="btn-wrap-text" title="Wrap Text"><i class="fa fa-arrow-turn-down"></i></button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
            <button id="btn-highlight-parent" title="Highlight Parent Task"><i class="fa fa-layer-group"></i></button>
            <button id="btn-collapse-parents" title="Collapse Parent Task"><i class="fa fa-compress"></i></button>
            <button id="btn-export-excel" title="Export to Excel"><i class="fa fa-file-excel"></i></button>
        </div>
        <div class="toolbar-spacer"></div>
        <div id="save-status" style="display:none;">
            <i id="save-status-icon"></i>
            <span id="save-status-text"></span>
        </div>
    </div>

    <!-- Protected View Bar -->
    <div id="protected-view-bar">
        <div class="pv-left">
            <i class="fa fa-shield-halved pv-icon"></i>
            <span class="pv-text"><strong>PROTECTED VIEW</strong> &mdash; This worksheet is locked. Any changes made will not be saved.</span>
        </div>
        <div class="pv-right">
            <button id="pv-close" class="pv-close-btn" title="Close"><i class="fa fa-xmark"></i></button>
        </div>
    </div>

    <!-- Spreadsheet Container -->
    <div id="spreadsheet-container">
        <table id="spreadsheet">
            <thead>
                <tr id="header-row">
                    <th class="row-number-header">&nbsp;</th>
                    <!-- Column headers generated by JS -->
                </tr>
            </thead>
            <tbody id="spreadsheet-body">
                <!-- Rows generated by JS -->
            </tbody>
        </table>
    </div>

    <!-- Column Context Menu -->
    <div id="column-context-menu" class="context-menu">
        <div class="menu-item" data-action="insert-left">
            <i class="fa fa-arrow-left"></i> Insert Column Left
        </div>
        <div class="menu-item" data-action="insert-right">
            <i class="fa fa-arrow-right"></i> Insert Column Right
        </div>
        <div class="menu-divider"></div>
        <div class="menu-item" data-action="rename-column">
            <i class="fa fa-pen"></i> Rename Column...
        </div>
        <div class="menu-item" data-action="add-description">
            <i class="fa fa-circle-info"></i> Add Column Description...
        </div>
        <div class="menu-item" data-action="delete-column">
            <i class="fa fa-trash"></i> Delete Column
        </div>
        <div class="menu-divider"></div>
        <div class="menu-item" data-action="filter">
            <i class="fa fa-filter"></i> Filter...
        </div>
        <div class="menu-item" data-action="sort-rows">
            <i class="fa fa-arrow-down-short-wide"></i> Sort Rows...
        </div>
        <div class="menu-item" data-action="lock-column">
            <i class="fa fa-lock"></i> Lock Column
        </div>
        <div class="menu-item" data-action="freeze-column">
            <i class="fa fa-snowflake"></i> Freeze Column
        </div>
        <div class="menu-item" data-action="hide-column">
            <i class="fa fa-eye-slash"></i> Hide Column
        </div>
        <div class="menu-divider"></div>
        <div class="menu-item" data-action="column-properties">
            <i class="fa fa-sliders"></i> Column Properties
        </div>
    </div>

    <!-- Row Context Menu -->
    <div id="row-context-menu" class="context-menu">
        <div class="menu-item" data-row-action="insert-above">
            <i class="fa fa-arrow-up"></i> Insert Above
        </div>
        <div class="menu-item" data-row-action="insert-below">
            <i class="fa fa-arrow-down"></i> Insert Below
        </div>
        <div class="menu-divider"></div>
        <div class="menu-item" data-row-action="cut">
            <i class="fa fa-scissors"></i> Cut
            <span class="menu-shortcut">Ctrl + X</span>
        </div>
        <div class="menu-item" data-row-action="copy">
            <i class="fa fa-copy"></i> Copy
            <span class="menu-shortcut">Ctrl + C</span>
        </div>
        <div class="menu-item" data-row-action="paste">
            <i class="fa fa-paste"></i> Paste
            <span class="menu-shortcut">Ctrl + V</span>
        </div>
        <div class="menu-divider"></div>
        <div class="menu-item menu-item-danger" data-row-action="delete">
            <i class="fa fa-trash"></i> <span id="delete-row-label">Delete Row</span>
        </div>
    </div>

    <!-- Project Picker Dialog -->
    <div id="project-picker" class="dialog-overlay" style="display:none;">
        <div class="dialog-box dialog-box-picker">
            <div class="picker-section-header">
                <h3>Group Project</h3>
            </div>
            <div id="group-table-wrap">
                <table id="group-table" class="picker-table-shared">
                    <thead>
                        <tr>
                            <th>Project Name</th>
                            <th>Last Saved</th>
                            <th>Entries</th>
                        </tr>
                    </thead>
                    <tbody id="group-table-body">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
            <div id="group-loading" class="picker-loading" style="display:none;">
                <i class="fa fa-spinner fa-spin"></i>
                <span>Please wait...</span>
            </div>
            <div id="group-empty" class="picker-empty" style="display:none;">
                No group project yet.
            </div>

        </div>
    </div>

    <!-- Rename Dialog -->
    <div id="rename-dialog" class="dialog-overlay" style="display:none;">
        <div class="dialog-box">
            <h3>Rename Column</h3>
            <input type="text" id="rename-input" placeholder="Enter column name">
            <div class="dialog-buttons">
                <button id="rename-cancel" class="btn-cancel">Cancel</button>
                <button id="rename-ok" class="btn-ok">OK</button>
            </div>
        </div>
    </div>

    <!-- Description Dialog -->
    <div id="description-dialog" class="dialog-overlay" style="display:none;">
        <div class="dialog-box">
            <h3>Column Description</h3>
            <textarea id="description-input" placeholder="Enter column description" rows="4"></textarea>
            <div class="dialog-buttons">
                <button id="description-cancel" class="btn-cancel">Cancel</button>
                <button id="description-ok" class="btn-ok">OK</button>
            </div>
        </div>
    </div>

    <!-- Sort Dialog -->
    <div id="sort-dialog" class="dialog-overlay" style="display:none;">
        <div class="dialog-box">
            <h3>Sort Rows</h3>
            <div class="sort-options">
                <label><input type="radio" name="sort-order" value="asc" checked> Ascending (A → Z, Oldest → Newest)</label>
                <label><input type="radio" name="sort-order" value="desc"> Descending (Z → A, Newest → Oldest)</label>
            </div>
            <div class="dialog-buttons">
                <button id="sort-cancel" class="btn-cancel">Cancel</button>
                <button id="sort-ok" class="btn-ok">Sort</button>
            </div>
        </div>
    </div>

    <!-- Filter Dialog -->
    <div id="filter-dialog" class="dialog-overlay" style="display:none;">
        <div class="dialog-box">
            <h3>Filter Column</h3>
            <input type="text" id="filter-input" placeholder="Filter value (leave empty to clear)">
            <div class="dialog-buttons">
                <button id="filter-cancel" class="btn-cancel">Cancel</button>
                <button id="filter-ok" class="btn-ok">Apply</button>
            </div>
        </div>
    </div>

    <!-- Column Properties Dialog -->
    <div id="colprops-dialog" class="dialog-overlay" style="display:none;">
        <div class="dialog-box dialog-box-wide">
            <h3>Column Properties</h3>
            <div class="form-group">
                <label class="form-label">Column name</label>
                <input type="text" id="colprops-name" placeholder="Enter column name">
            </div>
            <div class="form-group">
                <label class="form-label">Column description <span class="label-hint">(optional)</span></label>
                <textarea id="colprops-description" placeholder="" rows="3"></textarea>
            </div>
            <hr class="form-divider">
            <div class="form-group">
                <label class="form-label">Column type</label>
                <select id="colprops-type">
                    <option value="text">A1&nbsp;&nbsp;Text/Number</option>
                    <option value="dropdown">&#9662;&nbsp;&nbsp;Dropdown List</option>
                    <option value="date">&#128197;&nbsp;&nbsp;Date</option>
                    <option value="checkbox">&#9745;&nbsp;&nbsp;Checkbox</option>
                    <option value="symbols">&#9881;&nbsp;&nbsp;Symbols</option>
                    <option value="duration">&#9202;&nbsp;&nbsp;Work Days</option>
                    <option value="percent">&#37;&nbsp;&nbsp;Percent Complete</option>
                    <option value="cost">&#36;&nbsp;&nbsp;Cost</option>
                    <option value="contacts">&#128101;&nbsp;&nbsp;Contacts</option>
                    <option value="predecessor">&#128279;&nbsp;&nbsp;Predecessor</option>
                </select>
            </div>
            <!-- Symbols Style Section (shown only when type = symbols) -->
            <div id="symbols-style-section" style="display:none;">
                <hr class="form-divider">
                <div class="form-group">
                    <label class="form-label">Symbol style</label>
                    <select id="symbols-style-select">
                        <option value="status" selected>
                            &#x2705; &#x26A0;&#xFE0F; &#x274C;&nbsp;&nbsp;OK / Warning / Problem
                        </option>
                    </select>
                </div>
            </div>
            <!-- Duration Config Section (shown only when type = duration) -->
            <div id="duration-config-section" style="display:none;">
                <hr class="form-divider">
                <div class="form-group">
                    <label class="form-label">Beginning date column</label>
                    <select id="duration-start-col">
                        <option value="">— Select —</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Ending date column</label>
                    <select id="duration-end-col">
                        <option value="">— Select —</option>
                    </select>
                </div>
            </div>
            <!-- Dropdown List Values Section (shown only when type = dropdown) -->
            <div id="dropdown-values-section" style="display:none;">
                <hr class="form-divider">
                <div class="form-group">
                    <label class="form-label">Dropdown list values</label>
                    <div id="dropdown-values-list">
                        <!-- Generated by JS -->
                    </div>
                    <div class="dropdown-add-row">
                        <input type="text" id="dropdown-new-value" placeholder="Enter or paste values">
                        <button id="dropdown-add-btn" class="btn-ok btn-sm" title="Add Value"><i class="fa fa-plus"></i> Add Value</button>
                    </div>
                </div>
            </div>
            <div class="dialog-buttons">
                <button id="colprops-cancel" class="btn-cancel">Cancel</button>
                <button id="colprops-apply" class="btn-ok">Apply</button>
            </div>
        </div>
    </div>

    <div id="info-dialog" class="dialog-overlay" style="display:none;">
        <div class="dialog-box">
            <h3 id="info-dialog-title" style="margin-bottom:12px;"></h3>
            <p id="info-dialog-message" style="color:#555; font-size:13px; line-height:1.5;"></p>
            <div class="dialog-buttons">
                <button id="info-dialog-ok" class="btn-ok">OK</button>
            </div>
        </div>
    </div>

    <!-- Row Details Sidebar -->
    <div id="row-sidebar" class="sidebar-panel">
        <div class="sidebar-header">
            <h3 id="sidebar-title">Row Details</h3>
            <div class="sidebar-header-actions">
                <button id="sidebar-close" title="Close"><i class="fa fa-xmark"></i></button>
            </div>
        </div>
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" data-tab="details"><i class="fa fa-list-ul"></i> Details</button>
            <button class="sidebar-tab" data-tab="notes"><i class="fa fa-sticky-note"></i> Notes</button>
            <button class="sidebar-tab" data-tab="logs"><i class="fa fa-clock-rotate-left"></i> Logs</button>
        </div>
        <div class="sidebar-body">
            <!-- Details Tab -->
            <div class="sidebar-tab-content active" data-tab-content="details">
                <div id="sidebar-fields">
                    <!-- Generated by JS -->
                </div>
            </div>
            <!-- Notes Tab -->
            <div class="sidebar-tab-content" data-tab-content="notes">
                <div class="sidebar-notes-section">
                    <h4 class="sidebar-section-title">Notes</h4>
                    <div class="notes-subtabs" id="notes-subtabs"></div>
                    <textarea id="sidebar-notes" class="sidebar-notes-input" placeholder="No notes for this task." rows="5" readonly></textarea>
                </div>
                <div class="sidebar-attachments-section">
                    <div class="sidebar-section-header">
                        <h4 class="sidebar-section-title">Attachments</h4>
                    </div>
                    <div id="sidebar-attachments" class="attachments-area">
                        <div class="attachments-placeholder">
                            <i class="fa fa-paperclip"></i>
                            <p>No attachments</p>
                        </div>
                        <div id="attachment-list" class="attachment-list"></div>
                    </div>
                </div>
                <div class="sidebar-comments-section" id="sidebar-admin-comments" style="display:none;">
                    <h4 class="sidebar-section-title">Admin Comments</h4>
                    <div id="sidebar-comments-list" class="comments-list"></div>
                    <div class="comment-input-area">
                        <textarea id="sidebar-comment-input" placeholder="Add a comment..." rows="2"></textarea>
                        <button id="sidebar-add-comment" class="btn-ok btn-sm">Add</button>
                    </div>
                </div>
            </div>
            <!-- Logs Tab -->
            <div class="sidebar-tab-content" data-tab-content="logs">
                <div class="sidebar-logs-section">
                    <p class="sidebar-logs-placeholder"><i class="fa fa-clock-rotate-left"></i> No logs yet.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Worksheet Contact Dropdown -->
    <div id="ws-contact-dropdown" style="display:none;">
        <input type="text" id="ws-contact-filter" placeholder="Search contacts...">
        <div id="ws-contact-dropdown-list"></div>
        <div class="ws-contact-dropdown-footer">
            <span class="ws-add-contact-icon"><i class="fa fa-user-plus"></i></span>
            <a href="#" id="ws-btn-add-new-contact">+ Add New</a>
        </div>
    </div>

    <!-- Predecessor Multi-Select Dropdown -->
    <div id="ws-pred-dropdown" style="display:none;">
        <input type="text" id="ws-pred-filter" placeholder="Search tasks...">
        <div id="ws-pred-dropdown-list"></div>
    </div>

    <!-- Add Contact Dialog (Worksheet) -->
    <div id="ws-add-contact-dialog" class="dialog-overlay" style="display:none;">
        <div class="dialog-box">
            <h3>Add New Contact</h3>
            <div class="form-group">
                <label class="form-label">Full Name</label>
                <input type="text" id="ws-new-contact-name" placeholder="First Last">
            </div>
            <div class="form-group">
                <label class="form-label">ID</label>
                <input type="text" id="ws-new-contact-id" placeholder="e.g. ab1234">
            </div>
            <div class="dialog-buttons">
                <button id="ws-add-contact-cancel" class="btn-cancel">Cancel</button>
                <button id="ws-add-contact-ok" class="btn-ok">Add</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.1/spectrum.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.4.0/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>
    <script src="view.js"></script>
</body>
</html>
